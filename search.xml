<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>SMR 分析</title>
    <url>/2024/06/14/10.SMR/</url>
    <content><![CDATA[<h1 id="SMR-教程"><a href="#SMR-教程" class="headerlink" title="SMR 教程"></a>SMR 教程</h1><p>官方文档：<a href="https://yanglab.westlake.edu.cn/software/smr/">SMR | Yang Lab (westlake.edu.cn)</a></p>
<h2 id="1-数据获取"><a href="#1-数据获取" class="headerlink" title="1.数据获取"></a>1.数据获取</h2><h3 id="1-1eqtl数据"><a href="#1-1eqtl数据" class="headerlink" title="1.1eqtl数据"></a>1.1eqtl数据</h3><p>qtl数据获取主要从GTEx数据库，可以得到各种组织的数据。GTEx数据库的速度很慢建议从SMR官网的数据库下载（华人做的）<a href="https://yanglab.westlake.edu.cn/software/smr/#DataResource">SMR | Yang Lab (westlake.edu.cn)</a>里面有各种qtl的数据集，下得很快！</p>
<p>eqtl还有血液的数据，样本量很大<a href="https://www.eqtlgen.org/cis-eqtls.html">eQTLGen - cis-eQTLs</a></p>
<p>直接下载besd二进制格式即可，后期数据可以用smr软件自提</p>
<h3 id="1-2GWAS数据"><a href="#1-2GWAS数据" class="headerlink" title="1.2GWAS数据"></a>1.2GWAS数据</h3><p>GWAS数据获取的方法很多可以直接去<a href="https://gwas.mrcieu.ac.uk/">IEU OpenGWAS project (mrcieu.ac.uk)</a>下载，也可以通过R包TwoSampleMR直接从网站上拽。available_outcomes()函数可以看到openGWAS里面所有的gwas数据</p>
<p>当然还有很多别的获取手段。也可以从finngen的GWAS获取</p>
<h3 id="1-3参考基因组"><a href="#1-3参考基因组" class="headerlink" title="1.3参考基因组"></a>1.3参考基因组</h3><p>用R包下载<a href="https://privefl.github.io/bigsnpr/reference/download_1000G.html">Download 1000G — download_1000G • bigsnpr (privefl.github.io)</a></p>
<p>也可以直接链接：<a href="http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz">http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz</a></p>
<p>也可以自行从官网下载</p>
<p>不难发现，所需数据全是公共数据，而且获取比较轻松。</p>
<h2 id="2-SMR"><a href="#2-SMR" class="headerlink" title="2.SMR"></a>2.SMR</h2><h3 id="2-1软件下载"><a href="#2-1软件下载" class="headerlink" title="2.1软件下载"></a>2.1软件下载</h3><p><a href="https://yanglab.westlake.edu.cn/software/smr/#Download">SMR | Yang Lab (westlake.edu.cn)</a>下载即可，Windows和Linux均可</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">smr --bld mybld --gwas-summary mygwas.ma --beqtl-summary myeqtl --out mysmr --thread-num 10 </span><br></pre></td></tr></table></figure>

<p>smr输入有</p>
<pre><code>--bld 指的是1000人参考基因组的目录，

--gwas-summary输入的是GWAS数据，

--beqtl-summary 输入的是eqtl数据，

--query 5e-8

--gene ENSG00000113161

--out 输出文集名

--make-besd
</code></pre>
<p>*<strong>mygwas.ma*</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SNP    A1  A2  freq    b   se  p   n</span><br><span class="line">rs1001    A   G   0.8493  0.0024  0.0055  0.6653  129850</span><br><span class="line">rs1002    C   G   0.03606 0.0034  0.0115  0.7659  129799</span><br><span class="line">rs1003    A   C   0.5128  0.045   0.038   0.2319  129830</span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exp</span><span class="operator">&lt;-</span>fread<span class="punctuation">(</span><span class="string">&#x27;GCST004744-EFO_0000571-Build37.f.tsv.gz&#x27;</span><span class="punctuation">,</span>data.table <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">tail<span class="punctuation">(</span><span class="built_in">exp</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">exp</span><span class="operator">$</span>n<span class="operator">&lt;-</span><span class="number">66756</span></span><br><span class="line"><span class="comment">##ebi常用格式</span></span><br><span class="line">LUAD<span class="operator">&lt;-</span><span class="built_in">exp</span><span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>str_detect<span class="punctuation">(</span>variant_id<span class="punctuation">,</span> <span class="string">&quot;^rs&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>rename<span class="punctuation">(</span></span><br><span class="line">    SNP<span class="operator">=</span>variant_id<span class="punctuation">,</span></span><br><span class="line">    A1<span class="operator">=</span>effect_allele<span class="punctuation">,</span> </span><br><span class="line">    A2<span class="operator">=</span>other_allele<span class="punctuation">,</span></span><br><span class="line">    freq<span class="operator">=</span>effect_allele_frequency<span class="punctuation">,</span> </span><br><span class="line">    b<span class="operator">=</span>beta<span class="punctuation">,</span></span><br><span class="line">    se<span class="operator">=</span>standard_error<span class="punctuation">,</span></span><br><span class="line">    p<span class="operator">=</span>p_value<span class="punctuation">,</span></span><br><span class="line">    N<span class="operator">=</span>n </span><br><span class="line">  <span class="punctuation">)</span><span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>select<span class="punctuation">(</span>SNP<span class="punctuation">,</span> A1<span class="punctuation">,</span> A2<span class="punctuation">,</span> freq<span class="punctuation">,</span> b<span class="punctuation">,</span> se<span class="punctuation">,</span> p<span class="punctuation">,</span> N<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span><span class="operator">!</span>str_detect<span class="punctuation">(</span>SNP<span class="punctuation">,</span> <span class="string">&quot;,&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">##finngen常用格式</span></span><br><span class="line">LUAD<span class="operator">&lt;-</span><span class="built_in">exp</span><span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>str_detect<span class="punctuation">(</span>rsids<span class="punctuation">,</span> <span class="string">&quot;^rs&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>rename<span class="punctuation">(</span></span><br><span class="line">    SNP<span class="operator">=</span>rsids<span class="punctuation">,</span></span><br><span class="line">    A1<span class="operator">=</span>alt<span class="punctuation">,</span> </span><br><span class="line">    A2<span class="operator">=</span>ref<span class="punctuation">,</span></span><br><span class="line">    freq<span class="operator">=</span>af_alt<span class="punctuation">,</span> </span><br><span class="line">    b<span class="operator">=</span>beta<span class="punctuation">,</span></span><br><span class="line">    se<span class="operator">=</span>sebeta<span class="punctuation">,</span></span><br><span class="line">    p<span class="operator">=</span>pval<span class="punctuation">,</span></span><br><span class="line">    N<span class="operator">=</span>n </span><br><span class="line">  <span class="punctuation">)</span><span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>select<span class="punctuation">(</span>SNP<span class="punctuation">,</span> A1<span class="punctuation">,</span> A2<span class="punctuation">,</span> freq<span class="punctuation">,</span> b<span class="punctuation">,</span> se<span class="punctuation">,</span> p<span class="punctuation">,</span> N<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span><span class="operator">!</span>str_detect<span class="punctuation">(</span>SNP<span class="punctuation">,</span> <span class="string">&quot;,&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>LUAD<span class="punctuation">,</span><span class="number">804</span><span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>LUAD<span class="punctuation">,</span><span class="string">&#x27;LUAD.ma&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> col.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://yanglab.westlake.edu.cn/software/smr/#QueryeQTLSummaryResults">SMR 具体eqtlgen转换要求</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#超算平台</span><br><span class="line">cd &quot;/public/home/fanfangzhou/apps/SMR/smr_linux&quot; </span><br><span class="line"></span><br><span class="line">##这里获取的是含有eQTLGen的HMGCR这基因的besd格式的</span><br><span class="line">&quot;/public/home/fanfangzhou/apps/SMR/smr_linux&quot; </span><br><span class="line">	--beqtl-summary &quot;/public/home/fanfangzhou/R/GTEx8/SMR/eQTLGen/cis-eQTLs-full_eQTLGen_AF_incl_nr_formatted_20191212.new.txt_besd-dense&quot; </span><br><span class="line">	--query 1 </span><br><span class="line">	--gene ENSG00000113161 </span><br><span class="line">	--out &quot;/public/home/fanfangzhou/R/2024science/6. Drugs mendelian/rotator cuff syndrome/rotator cuff injury/SMR/&quot; </span><br><span class="line">	--make-besd</span><br><span class="line"></span><br><span class="line">##这里获取了HMGCR的besd格式文件，就可以在这个区间进行SMR分析</span><br><span class="line">&quot;/public/home/fanfangzhou/apps/SMR/smr_linux&quot;  </span><br><span class="line">	--bfile &quot;/public/home/fanfangzhou/R/Rcodes/486metabolites/1kg.v3/EUR&quot; </span><br><span class="line">	--gwas-summary SMR_rotatorcuffR9.ma </span><br><span class="line">	--beqtl-summary HMGCR </span><br><span class="line">	--out rotatorblood  </span><br><span class="line">	--thread-num 10 </span><br></pre></td></tr></table></figure>

<h3 id="2-3运行smr"><a href="#2-3运行smr" class="headerlink" title="2.3运行smr"></a>2.3运行smr</h3><p>命令很简单，找着官网的改一改就行</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">##超算平台</span><br><span class="line">&quot;/public/home/fanfangzhou/apps/SMR/smr_linux&quot;  --bfile &quot;/public/home/fanfangzhou/R/Rcodes/486metabolites/1kg.v3/EUR&quot; --gwas-summary LUAD.ma --beqtl-summary &quot;/public/home/fanfangzhou/R/GTEx8/SMR/Whole_Blood/Whole_Blood&quot; --out Lung_SMR_wholeblood --thread-num 10 --diff-freq-prop 0.92</span><br></pre></td></tr></table></figure>

<p>–<strong>diff-freq-prop 参数是等位基因频率的设定阈值，如果小的话程序是跑不通的。因为我输入的eqtl和gwas数据没经过过滤，被筛掉的snp的比例非常大，所以需要把这个阈值设高点防止程序终止。</strong></p>
<h2 id="3-共定位"><a href="#3-共定位" class="headerlink" title="3.共定位"></a>3.共定位</h2><p>细心的朋友会发现，刚才我们并没有下载eqtl的txt列表格式的文件，理论上和gwas一样，eqtl也应该有一个非常大数据量的列表文件，那么如何得到呢，依然是靠smr软件</p>
<p>这里可以用eqtlgen的也可以用V8的，***–make-besd<em><strong>加这个就是输出</strong>besd</em><em>格式的（三种文件那种），或者不加就是默认*<em>txt</em></em></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">smr-1.3.1-win.exe --beqtl-summary Artery_Aorta --query 0.05 --out Aorta_eqtl</span><br></pre></td></tr></table></figure>

<p>smr可以从二进制的besd文件中导出txt格式的eqtl文件，得到这里是Aorta_eqtl.txt文件</p>
<h2 id="4-SMR-locus-plot"><a href="#4-SMR-locus-plot" class="headerlink" title="4.SMR locus plot"></a>4.SMR locus plot</h2><p><a href="https://yanglab.westlake.edu.cn/software/smr/#SMRlocusplot19">SMR | Yang Lab (westlake.edu.cn)</a></p>
<h3 id="SMR-locus-plot"><a href="#SMR-locus-plot" class="headerlink" title="SMR locus plot"></a>SMR locus plot</h3><p>Here we provide an R script to plot SMR results as presented in Zhu et al. (<a href="http://www.nature.com/ng/journal/vaop/ncurrent/full/ng.3538.html">2016 Nature Genetics</a>). The data file for plot can be generated by the command below. The R script is avaliable at <a href="https://yanglab.westlake.edu.cn/software/smr/#Download">Download</a>.</p>
<h4 id="SMR-command-line-to-generate-a-data-file-for-plot"><a href="#SMR-command-line-to-generate-a-data-file-for-plot" class="headerlink" title="# SMR command line to generate a data file for plot"></a># SMR command line to generate a data file for plot</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smr --bfile mydata --gwas-summary mygwas.ma --beqtl-summary myeqtl --out myplot --plot --probe ILMN_123 --probe-wind 500 --gene-list glist-hg19 </span><br></pre></td></tr></table></figure>

<h2 id="5-Multi-SNP-based-SMR-test"><a href="#5-Multi-SNP-based-SMR-test" class="headerlink" title="5.Multi-SNP-based SMR test"></a>5.Multi-SNP-based SMR test</h2><p>Below shows an option to combine the information from all the SNPs in a region that pass a p-value threshold (the default value is 5.0e-8 which can be modified by the flag <strong>–peqtl-smr</strong>) to conduct a multi-SNP-based SMR analysis (<a href="https://www.nature.com/articles/s41467-018-03371-0">Wu et al. 2018 Nature Communications</a>).</p>
<p>The SNPs are pruned for LD using a weighted vertex coverage algorithm with a LD r2 threshold (the default value is 0.9 which can be modified by the flag <strong>–ld-pruning</strong>) and eQTL p-value as the weight.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smr --bfile mydata --gwas-summary mygwas.ma --beqtl-summary myeqtl --out mymulti --smr-multi </span><br></pre></td></tr></table></figure>

<p><strong>–smr-multi</strong> turns on set-based SMR test in the cis-region.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smr --bfile mydata --gwas-summary mygwas.ma --beqtl-summary myeqtl --out mymulti --smr-multi --set-wind 500 </span><br></pre></td></tr></table></figure>

<p><strong>–set-wind</strong> defines a window width (Kb) centred around the top associated cis-eQTL to select SNPs in the cis-region. The default value is -9 resulting in selecting SNPs in the whole cis-region if this option is not specified.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smr --bfile mydata --gwas-summary mygwas.ma --beqtl-summary myeqtl --out mymulti --smr-multi  --ld-multi-snp 0.1 </span><br></pre></td></tr></table></figure>

<p><strong>–ld-multi-snp</strong> LD r-squared threshold used to prune SNPs (eQTLs) in the Multi-SNP based SMR test. The default value is 0.1.</p>
<blockquote>
<p>最初提出的定义独立顺式-eQTL的阈值为<em>r</em>2&lt; 0.9。然而，该阈值可能包括具有高 LD 的 SNP（定义为 <em>r</em> 2≥ 0.1）。因此，我们采用了 <em>r</em> 2&lt; 0.1 作为定义独立 SNP 的阈值</p>
</blockquote>
<p>参考文献：<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9538104/">基于转录组全汇总数据的孟德尔随机化分析揭示了 38 个与严重 COVID-19 相关的新基因 - PMC (nih.gov)</a></p>
<h3 id="GTEx-V8-基因注释"><a href="#GTEx-V8-基因注释" class="headerlink" title="GTEx V8 基因注释"></a>GTEx V8 基因注释</h3><p><a href="https://gtexportal.org/home/downloads/adult-gtex/bulk_tissue_expression">GTEx Portal</a>网址里面的：<a href="https://storage.googleapis.com/adult-gtex/bulk-gex/v8/rna-seq/GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct.gz">https://storage.googleapis.com/adult-gtex/bulk-gex/v8/rna-seq/GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct.gz</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GTEx&lt;-read.table(&quot;GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct&quot;, skip = 2, header = TRUE, sep = &quot;\t&quot;) save(GTEx,file = &#x27;GTEx.Rdata&#x27;) </span><br><span class="line">GTEx[1:4,1:4] ##行是基因 列是样本 </span><br><span class="line"># Name    Description       GTEX.1117F.0226.SM.5GZZ7 GTEX.1117F.0426.SM.5EGHI </span><br><span class="line"># 1 ENSG00000223972.5 DDX11L1 0 0 </span><br><span class="line"># 2 ENSG00000227232.5 WASH7P 187 109 </span><br><span class="line"># 3 ENSG00000278267.1 MIR6859-1 0 0 </span><br><span class="line"># 4 ENSG00000243485.5 MIR1302-2HG 1 0 </span><br><span class="line">colnames(GTEx)</span><br></pre></td></tr></table></figure>

<h2 id="5-常用数据"><a href="#5-常用数据" class="headerlink" title="5.常用数据"></a>5.常用数据</h2><h3 id="V8-release-of-the-GTEx-eQTL-x2F-sQTL-summary-data"><a href="#V8-release-of-the-GTEx-eQTL-x2F-sQTL-summary-data" class="headerlink" title="V8 release of the GTEx eQTL&#x2F;sQTL summary data"></a><em>V8 release of the GTEx eQTL&#x2F;sQTL summary data</em></h3><p>V8 release of the GTEx eQTL&#x2F;sQTL summary data (n &#x3D; 73 - 670; [GTEx Consortium 2020 Science](<a href="https://www.science.org/doi/10.1126/science.aaz1776?url_ver=Z39.88-2003&rfr_id=ori:rid:crossref.org&rfr_dat=cr_pub">https://www.science.org/doi/10.1126/science.aaz1776?url_ver=Z39.88-2003&amp;rfr_id=ori:rid:crossref.org&amp;rfr_dat=cr_pub</a>  0pubmed)) in SMR binary (BESD) format:</p>
<p><a href="https://yanglab.westlake.edu.cn/data/SMR/GTEx_V8_cis_eqtl_summary.html">GTEx_V8_cis_eqtl_summary(hg19)</a> (48 GB)</p>
<p><a href="https://yanglab.westlake.edu.cn/data/SMR/GTEx_V8_cis_eqtl_summary_lite.tar">GTEx_V8_cis_eqtl_summary_lite</a> (hg19) Lite version of the GTEx V8 eqtl data (only SNPs with P &lt; 1e-5 are included; 506MB)</p>
<p>This is a set of cis-eQTL summary data across 49 human tissues from the GTEx project. Only SNPs within 1Mb of the transcription start site are available. The forth column of the *.epi file is the middle position of the probe sequence rather than the transcription start site.</p>
<h3 id="cis-eQTLs"><a href="#cis-eQTLs" class="headerlink" title="cis-eQTLs"></a><em>cis</em>-eQTLs</h3><p>This page contains the <em>cis</em>-eQTL results. The statistically significant <em>cis</em>-eQTLs and SMR-prioritised genes for several traits are browsable, the other files can be downloaded.</p>
<h5 id="Downloads"><a href="#Downloads" class="headerlink" title="Downloads"></a>Downloads</h5><ul>
<li><a href="https://molgenis26.gcc.rug.nl/downloads/eqtlgen/cis-eqtl/2019-12-11-cis-eQTLsFDR0.05-ProbeLevel-CohortInfoRemoved-BonferroniAdded.txt.gz">Significant <em>cis</em>-eQTLs</a></li>
<li><a href="https://molgenis26.gcc.rug.nl/downloads/eqtlgen/cis-eqtl/2019-12-11-cis-eQTLsFDR-ProbeLevel-CohortInfoRemoved-BonferroniAdded.txt.gz">Full <em>cis</em>-eQTL summary statistics</a></li>
<li><a href="https://molgenis26.gcc.rug.nl/downloads/eqtlgen/cis-eqtl/README_cis">README</a></li>
<li><a href="https://molgenis26.gcc.rug.nl/downloads/eqtlgen/cis-eqtl/cis-eQTL_significant_20181017.txt.gz">Initial release Significant <em>cis</em>-eQTLs</a> (deprecated)</li>
<li><a href="https://molgenis26.gcc.rug.nl/downloads/eqtlgen/cis-eqtl/cis-eQTLs_full_20180905.txt.gz">Initial release Full <em>cis</em>-eQTL summary statistics</a> (deprecated)</li>
</ul>
<h2 id="6-SMR使用技巧"><a href="#6-SMR使用技巧" class="headerlink" title="6.SMR使用技巧"></a>6.SMR使用技巧</h2><h3 id="6-1-批量使用49个组织的SMR"><a href="#6-1-批量使用49个组织的SMR" class="headerlink" title="6.1.批量使用49个组织的SMR"></a>6.1.批量使用49个组织的SMR</h3><p>首先在R里面创建我们需要的sh格式的文件，当然我们可以进行txt简单创建</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">original_string1 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">echo Whole_Blood</span></span><br><span class="line"><span class="string">&quot;/public/home/fanfangzhou/apps/SMR/smr_linux&quot; --bfile &quot;/public/home/fanfangzhou/R/Rcodes/486metabolites/1kg.v3/EUR&quot; --gwas-summary LUAD.ma --beqtl-summary &quot;/public/home/fanfangzhou/R/GTEx8/SMR/Whole_Blood/Whole_Blood&quot; --out Lung_SMR_Whole_Blood --thread-num 10 --diff-freq-prop 0.92</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line">original_string2 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">echo Whole_Blood</span></span><br><span class="line"><span class="string">&quot;/public/home/fanfangzhou/apps/SMR/smr_linux&quot; --bfile &quot;/public/home/fanfangzhou/R/Rcodes/486metabolites/1kg.v3/EUR&quot; --gwas-summary LUAD.ma --beqtl-summary &quot;/public/home/fanfangzhou/R/GTEx8/SMR/Whole_Blood/Whole_Blood&quot; --out Lung_SMR_Whole_Blood_test  --smr-multi  --ld-multi-snp 0.1 </span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 待替换的字符串</span></span><br><span class="line">replace_values <span class="operator">&lt;-</span> original_string1  <span class="comment"># 替换值的向量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用替换值逐个替换原始字符串中的&quot;Whole_Blood&quot;</span></span><br><span class="line">replaced_strings <span class="operator">&lt;-</span> sapply<span class="punctuation">(</span>replace_values<span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>value<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  gsub<span class="punctuation">(</span><span class="string">&quot;Whole_Blood&quot;</span><span class="punctuation">,</span> value<span class="punctuation">,</span> original_string1<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">writeLines<span class="punctuation">(</span>replaced_strings<span class="punctuation">,</span> <span class="string">&quot;script.sh&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">command <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 输出 &quot;Hello, world!&quot; 消息</span></span><br><span class="line"><span class="string">echo &quot;Hello, world!&quot;</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line">writeLines<span class="punctuation">(</span>command<span class="punctuation">,</span> <span class="string">&quot;script.sh&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>然后我们在linux系统里面使用sh格式运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#使用 chmod 命令将该文件设置为可执行权限：</span></span><br><span class="line"><span class="built_in">chmod</span> +x my_script.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#执行该脚本文件：</span></span><br><span class="line">./my_script.sh</span><br></pre></td></tr></table></figure>

<h3 id="6-2-SMR-执行mult"><a href="#6-2-SMR-执行mult" class="headerlink" title="6.2.SMR 执行mult"></a>6.2.SMR 执行mult</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&quot;/public/home/fanfangzhou/apps/SMR/smr_linux&quot; --bfile &quot;/public/home/fanfangzhou/R/Rcodes/486metabolites/1kg.v3/EUR&quot; --gwas-summary ON.ma --beqtl-summary &quot;/public/home/fanfangzhou/R/GTEx8/SMR/eQTLGen/cis-eQTLs-full_eQTLGen_AF_incl_nr_formatted_20191212.new.txt_besd-dense&quot;  --out osteonecrosis_blood  --smr-multi  --ld-multi-snp 0.1 </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Post-GWAS analysis</category>
      </categories>
  </entry>
  <entry>
    <title>MRZhou simplify the mendelian randomization analysis</title>
    <url>/2024/06/15/MRZhou_README/</url>
    <content><![CDATA[<h1 id="MRZhou"><a href="#MRZhou" class="headerlink" title="MRZhou"></a>MRZhou</h1><p>This R package is designed for the convenience of medical professionals, aiming to further simplify the analysis methods of Mendelian randomization (MR). It is integrated based on the <a href="https://github.com/MRCIEU/TwoSampleMR/">TwosampleMR</a>, <a href="https://github.com/rondolab/MR-PRESSO">MRpresso</a>, and <a href="https://github.com/chr1swallace/coloc">coloc</a> packages. Therefore, whether it is the online data of the <a href="https://gwas.mrcieu.ac.uk/">IEU GWAS database</a> or local GWAS data (such as <a href="https://www.finngen.fi/en">FinnGen database</a>), this package can be conveniently executed. This package also includes: <a href="https://yanglab.westlake.edu.cn/software/gsmr/">GSMR analysis</a>, <a href="https://yanglab.westlake.edu.cn/software/smr/">SMR analysis</a> methods, etc. <a href="http://gusevlab.org/projects/fusion/">TWAS&#x2F;Fusion analysis</a> function method is under development.</p>
<p>When using this <a href="https://github.com/fangzhoufan/MRZhou">MRZhou</a> package, it is recommended to first learn the basic syntax of <a href="https://github.com/MRCIEU/TwoSampleMR/">TwosampleMR</a>.</p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>You can install the development version of MRZhou from <a href="https://github.com/">GitHub</a> with:</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># install.packages(&quot;devtools&quot;)</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&quot;fangzhoufan/MRZhou&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>This is a basic example which shows you how to solve a common problem:</p>
<h3 id="1-Exposure-and-Outcome"><a href="#1-Exposure-and-Outcome" class="headerlink" title="1.Exposure and Outcome"></a>1.Exposure and Outcome</h3><p>Let’s identify the instrumental variables (IVs) for BMI and extract the BMI-associated SNPs from the CAD (coronary artery disease) outcome GWAS data.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(MRZhou)</span><br><span class="line">exp &lt;- extract_instruments(outcomes = &quot;ieu-a-2&quot;)</span><br><span class="line">out &lt;- extract_outcome_data(exp$SNP,outcomes = &quot;ieu-a-7&quot;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>The above two functions are based on the <a href="https://github.com/MRCIEU/TwoSampleMR/">TwosampleMR</a> package, and detailed information can be found in the tutorial.</p>
</blockquote>
<p>If you would like to use the FinnGen database, you can follow: exposure:</p>
<ul>
<li>Exposure: <a href="https://storage.googleapis.com/finngen-public-data-r10/summary_stats/finngen_R10_BMI_IRN.gz">BMI</a></li>
<li>Outcome: <a href="https://storage.googleapis.com/finngen-public-data-r10/summary_stats/finngen_R10_I9_IHD.gz">CAD</a></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(MRZhou)</span><br><span class="line">data(&quot;finngenR9&quot;)</span><br><span class="line">data(&quot;finngenR10&quot;)</span><br><span class="line"># exp&lt;-read_finngen_exposure(&#x27;BMI&#x27;,&#x27;finngen_R10_BMI_IRN.gz&#x27;, 290820, p_threshold = 5e-08)</span><br><span class="line"># out&lt;-read_finngen_outcome(exp, &#x27;CAD&#x27;, &#x27;finngen_R10_I9_IHD.gz&#x27;, 412181)</span><br></pre></td></tr></table></figure>

<h3 id="2-IVW-analysis-main-analysis-method"><a href="#2-IVW-analysis-main-analysis-method" class="headerlink" title="2. IVW analysis (main analysis method)"></a>2. IVW analysis (main analysis method)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dat &lt;- harmonise_data(exp, out)</span><br><span class="line">result &lt;- IVW_fix_random(dat)</span><br><span class="line">test &lt;- mr_test(dat)</span><br><span class="line">presso &lt;- MRpresso(dat)</span><br><span class="line">resall &lt;- combine_results(result, test, presso)</span><br></pre></td></tr></table></figure>

<p>The resall dataframe is all of the MR methods results (including: MRpresso), Heterogeneity statistics and Horizontal pleiotropy results</p>
<h3 id="3-Plot"><a href="#3-Plot" class="headerlink" title="3.Plot"></a>3.Plot</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">## Not include MRpresso method results</span><br><span class="line">forest_plot &lt;- forest_plot(result)</span><br><span class="line"></span><br><span class="line">## Include MRpresso method results</span><br><span class="line">result2 &lt;- combine_results(result, NULL, presso)</span><br><span class="line">forest_plot &lt;- forest_plot(result2)</span><br></pre></td></tr></table></figure>

<h3 id="4-Other-Visualization"><a href="#4-Other-Visualization" class="headerlink" title="4.Other Visualization"></a>4.Other Visualization</h3><ul>
<li>Volcano plot</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">volcano_plot &lt;- volcano_plot(result)</span><br></pre></td></tr></table></figure>

<ul>
<li>Circle plot</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">circle_plot &lt;- circle_plot(result)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>MRZhou R package</category>
      </categories>
  </entry>
  <entry>
    <title>LDSC 分析</title>
    <url>/2024/06/14/4.LDSC%20software/</url>
    <content><![CDATA[<h2 id="连锁不平衡分数回归-LD-score-regression-LDSC"><a href="#连锁不平衡分数回归-LD-score-regression-LDSC" class="headerlink" title="连锁不平衡分数回归 LD score regression -LDSC"></a>连锁不平衡分数回归 LD score regression -LDSC</h2><h3 id="LDSC原理"><a href="#LDSC原理" class="headerlink" title="LDSC原理"></a>LDSC原理</h3><p>为什么要做 LD score regression</p>
<p>在GWAS研究中，多基因性（polygenicity，即若干较小的基因效应）和干扰因素引起的偏差（如隐性关联 cryptic relatedness，群体分层population stratification等）都会造成检验的统计量的分布偏高（inflated）。但我们并不能分辨偏高的统计量到底是来自多基因性还是干扰因素，所以通过LD score regression，我们可以通过研究检验统计量与连锁不平衡（linkage disequilibrium）之间的关系来定量分析每部分的影响。</p>
<p><strong>LDscore的原理？</strong></p>
<p><strong>GWAS检验中，对一个SNP效应量的估计通常也会包含与该SNP成LD的其他SNP的效应，也就是说一个与其他SNP成高LD的SNP，通常也会有更高的卡方检验量。</strong></p>
<p>接下来简单介绍如何进行LDscore regression。使用的软件为ldsc，可以从作者的github中拉取。ldsc为python脚本，clone了ldsc的库之后我们还需要利用anaconda配置环境，下载相关联的package。</p>
<p>ldsc：<a href="https://github.com/bulik/ldsc">https://github.com/bulik/ldsc</a></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/bulik/ldsc.git</span><br><span class="line">cd ldsc</span><br><span class="line">conda env create --file environment.yml ##一定要通过conda来配置相同环境 让他自己配置，他这个配置基于</span><br><span class="line">source activate ldsc</span><br></pre></td></tr></table></figure>

<p>以上步骤完成后，可以输入以下命令来检测是否安装成功</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">./ldsc.py -h</span><br><span class="line">./munge_sumstats.py -h</span><br></pre></td></tr></table></figure>

<p>除此以外，还需要相应群体的LD score，好消息是作者提供了处理好的欧洲 European 与 东亚 East asian的基于1000 genome的LD score以供我们使用，可以通过以下链接下载：</p>
<ul>
<li><a href="http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz">http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz</a></li>
<li><a href="https://github.com/perslab/CELLECT/blob/master/data/ldsc/w_hm3.snplist">https://github.com/perslab/CELLECT/blob/master/data/ldsc/w_hm3.snplist</a></li>
</ul>
<h3 id="使用教程"><a href="#使用教程" class="headerlink" title="使用教程"></a>使用教程</h3><p>本教程改编自： <a href="https://link.zhihu.com/?target=https://github.com/bulik/ldsc/wiki/Heritability-and-Genetic-Correlation">https://github.com/bulik/ldsc/wiki/Heritability-and-Genetic-Correlation</a></p>
<p>主要介绍：1.the LD Score regression intercept for a schizophrenia GWAS 与 2.the SNP-heritability for schizophrenia</p>
<p>使用的数据来自 2013年发表的 <a href="https://link.zhihu.com/?target=http://www.ncbi.nlm.nih.gov/pubmed/23453885">PGC Cross-Disorder paper in the Lancet</a>.，精神分裂症 sci 与 双相障碍 bip</p>
<h4 id="1-准备步骤"><a href="#1-准备步骤" class="headerlink" title="1 准备步骤"></a>1 准备步骤</h4><p>下载LD score</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">wget https://data.broadinstitute.org/alkesgroup/LDSCORE/eur_w_ld_chr.tar.bz2</span><br><span class="line">tar -jxvf eur_w_ld_chr.tar.bz2</span><br></pre></td></tr></table></figure>

<p>下载GWAS summary 统计量数据</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">wget www.med.unc.edu/pgc/files/resultfiles/pgc.cross.bip.zip</span><br><span class="line">wget www.med.unc.edu/pgc/files/resultfiles/pgc.cross.scz.zip</span><br></pre></td></tr></table></figure>

<p>下载后解压，head命令查看文件是否正确</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">head pgc.cross.BIP11.2013-05.txt</span><br><span class="line"></span><br><span class="line">snpid hg18chr bp a1 a2 or se pval info ngt CEUaf</span><br><span class="line">rs3131972	1	742584	A	G	1.092	0.0817	0.2819	0.694	0	0.16055</span><br><span class="line">rs3131969	1	744045	A	G	1.087	0.0781	0.2855	0.939	0	0.133028</span><br><span class="line">rs3131967	1	744197	T	C	1.093	0.0835	0.2859	0.869	0	.</span><br><span class="line"></span><br><span class="line">head pgc.cross.SCZ17.2013-05.txt</span><br><span class="line"></span><br><span class="line">snpid hg18chr bp a1 a2 or se pval info ngt CEUaf</span><br><span class="line">rs3131972	1	742584	A	G	1	0.0966	0.9991	0.702	0	0.16055</span><br><span class="line">rs3131969	1	744045	A	G	1	0.0925	0.9974	0.938	0	0.133028</span><br><span class="line">rs3131967	1	744197	T	C	1.001	0.0991	0.9928	0.866	0	.</span><br></pre></td></tr></table></figure>

<h4 id="2-第一步-数据清理-（munge-sumstats-py）"><a href="#2-第一步-数据清理-（munge-sumstats-py）" class="headerlink" title="2 第一步 数据清理 （munge_sumstats.py）"></a>2 第一步 数据清理 （munge_sumstats.py）</h4><p>原始数据并不是ldsc所需要的.sumstats 格式，所以我们需要先清理并提取需要的数据。利用ldsc附带的munge_sumstats.py可以将原始数据转换成.sumstats 格式。</p>
<p>The <code>ldsc</code> <code>.sumstats</code> format requires six pieces of information for each SNP:</p>
<ol>
<li>A unique identifier (e.g., the rs number)</li>
<li>Allele 1 (effect allele)</li>
<li>Allele 2 (non-effect allele)</li>
<li>Sample size (which often varies from SNP to SNP)</li>
<li>A P-value</li>
<li>A signed summary statistic (beta, OR, log odds, Z-score, etc)</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://data.broadinstitute.org/alkesgroup/LDSCORE/w_hm3.snplist.bz2</span><br><span class="line">bunzip2 w_hm3.snplist.bz2</span><br><span class="line"></span><br><span class="line">munge_sumstats.py \</span><br><span class="line">--sumstats pgc.cross.SCZ17.2013-05.txt \</span><br><span class="line">--N 17115 \</span><br><span class="line">--out scz \</span><br><span class="line">--merge-alleles w_hm3.snplist</span><br><span class="line"></span><br><span class="line">munge_sumstats.py \</span><br><span class="line">--sumstats pgc.cross.BIP11.2013-05.txt \</span><br><span class="line">--N 11810 \</span><br><span class="line">--out bip \</span><br><span class="line">--merge-alleles w_hm3.snplist</span><br></pre></td></tr></table></figure>

<p>注意：有时数据量较大时程序会卡死，无响应状态，可以尝试在选项中加上 –chunksize 500000 以解决此问题</p>
<p>输出的log文件</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Metadata:</span><br><span class="line">Mean chi^2 = 1.229</span><br><span class="line">Lambda GC = 1.201</span><br><span class="line">Max chi^2 = 32.4</span><br><span class="line">11 Genome-wide significant SNPs (some may have been removed by filtering).</span><br><span class="line"> </span><br><span class="line">Conversion finished at Mon Apr  4 13:21:29 2016</span><br><span class="line">Total time elapsed: 16.07s </span><br></pre></td></tr></table></figure>

<h4 id="3-第二步-LD-score-regression"><a href="#3-第二步-LD-score-regression" class="headerlink" title="3 第二步 LD score regression"></a>3 第二步 LD score regression</h4><p>利用清理好的数据，我们可以开始进行LD score regression，使用的是主程序ldsc.py</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">ldsc.py \</span><br><span class="line">--h2 scz.sumstats.gz \</span><br><span class="line">--ref-ld-chr eur_w_ld_chr/ \</span><br><span class="line">--w-ld-chr eur_w_ld_chr/ \</span><br><span class="line">--out scz_h2</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--</code>h2 ：计算遗传力，参数为上一步处理好的数据文件名</p>
<p><code>--ref-ld-chr</code> ：使用的按染色体号分类的LD score文件名，参数为LD score文件所在文件夹的路径。默认情况下ldsc会在文件名末尾添加染色体号，例如 <code>--ref-ld-chr eur_w_ld_chr/</code> 的意思就是使用 <code>eur_w_ld_chr/1.l2.ldscore ...</code> <code>eur_w_ld_chr/22.l2.ldscore</code> <code>这些文件</code>。如果你的染色体号在其他位置，也可以使用@来告诉LDSC，例如 <code>--ref-ld-chr ld/chr@</code> 。当然也可以用 <code>--ref-ld</code> 来指定一个整体的LD score文件。</p>
<p><code>--w-ld-chr</code>：指定ldsc回归权重所用的LDscore文件，理论上对于SNPj的LD分数，应当包含这个SNP与其他所有SNP的R2之和，但实际操作中，LD score回归对于计算权重的SNP的选择并不敏感，所以一般情况下我们可以使用与 <code>--ref-ld</code> 与相同的文件。.</p>
<p><code>--out</code> ： 输出文件的路径与前缀</p>
</blockquote>
<hr>
<p>ldsc输出的log文件结尾就是我们所要的结果，</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Total Observed scale h2: 0.5907 (0.0484)</span><br><span class="line">Lambda GC: 1.2038</span><br><span class="line">Mean Chi^2: 1.2336</span><br><span class="line">Intercept: 1.0014 (0.0113)</span><br><span class="line">Ratio: 0.0059 (0.0482)</span><br></pre></td></tr></table></figure>

<p>结果解读：</p>
<p>Total Observed scale h2： 总的观测尺度的遗传力 （详见<a href="https://link.zhihu.com/?target=https://gwaslab.com/2021/04/15/liability-scale-heritability-observed-scale-heri/">易感性尺度遗传力与观测尺度遗传力 Liability scale heritability &amp; observed scale heritability</a>）</p>
<p>Lambda GC 与 Mean chi^2： 用于评估群体分层与隐性关联的影响</p>
<p>Ratio： 定义为<em>attenuation ratio</em> &#x3D; (<em>LDSC</em> intercept – 1) &#x2F; (mean χ2 – 1)， 衰减比：用来估计混淆因素与遗传效应的相对平衡</p>
]]></content>
      <categories>
        <category>Post-GWAS analysis</category>
      </categories>
  </entry>
  <entry>
    <title>How to use the Hexo codes</title>
    <url>/2024/06/26/my%20blog/</url>
    <content><![CDATA[<h1 id="Blogs"><a href="#Blogs" class="headerlink" title="Blogs"></a>Blogs</h1><blockquote>
<p><strong>上述在本地文件夹blogs下打开git bash，后进行相关处理，部署是在github上</strong></p>
</blockquote>
<ul>
<li><a href="https://www.bilibili.com/video/BV16v411E7Po/?spm_id_from=333.788&vd_source=fb31d4e2b17609e8d63a5936e9a6e611">Video：Hexo部署使用</a></li>
<li><a href="https://blog.fiveth.cc/">Website：博客资料</a></li>
</ul>
<h2 id="1-常见的hexo使用命令"><a href="#1-常见的hexo使用命令" class="headerlink" title="1.常见的hexo使用命令"></a>1.常见的<code>hexo</code>使用命令</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#生成</span></span></span><br><span class="line">npx hexo g</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#上传</span></span></span><br><span class="line">npx hexo d</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#预览</span></span></span><br><span class="line"></span><br><span class="line">npx hexo serve</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#新建文章</span></span></span><br><span class="line"></span><br><span class="line">npx hexo n ‘myblog’</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使用VPN时，调整Git代理设置</span></span><br><span class="line">git config --global http.proxy</span><br><span class="line">git config --global https.proxy</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">未使用VPN时，取消Git代理设置</span></span><br><span class="line">git config --global --unset http.proxy</span><br><span class="line">git config --global --unset https.proxy</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>My blogs</category>
      </categories>
  </entry>
  <entry>
    <title>TWAS 分析</title>
    <url>/2024/06/14/2.TWAS%20&amp;%20FUSION/</url>
    <content><![CDATA[<h2 id="TWAS-FUSION"><a href="#TWAS-FUSION" class="headerlink" title="TWAS FUSION"></a>TWAS FUSION</h2><p><a href="http://gusevlab.org/projects/fusion/#multi-context-content-expression">TWAS &#x2F; FUSION (gusevlab.org)</a></p>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><ul>
<li>Download and unpack the <a href="https://github.com/gusevlab/fusion_twas">FUSION software package from github</a>:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/gusevlab/fusion_twas/archive/master.zip</span><br><span class="line">unzip master.zip</span><br><span class="line"><span class="built_in">cd</span> fusion_twas-master</span><br></pre></td></tr></table></figure>

<ul>
<li>Download and unpack the (1000 Genomes) <a href="https://data.broadinstitute.org/alkesgroup/FUSION/LDREF.tar.bz2">LD reference data</a>:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://data.broadinstitute.org/alkesgroup/FUSION/LDREF.tar.bz2</span><br><span class="line">tar xjvf LDREF.tar.bz2</span><br></pre></td></tr></table></figure>

<ul>
<li>Download and unpack the <a href="https://github.com/gabraham/plink2R">plink2R library</a> (by Gad Abraham):</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/gabraham/plink2R/archive/master.zip</span><br><span class="line">unzip master.zip</span><br></pre></td></tr></table></figure>

<ul>
<li>Launch R and install required libraries:</li>
</ul>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;optparse&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;RColorBrewer&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;plink2R-master/plink2R/&#x27;</span><span class="punctuation">,</span>repos<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="Typical-analysis-and-output——Examples"><a href="#Typical-analysis-and-output——Examples" class="headerlink" title="Typical analysis and output——Examples"></a>Typical analysis and output——Examples</h3><blockquote>
<p><strong>PGC精神分裂症的gwas summary数据对GTEx全血数据进行TWAS</strong></p>
</blockquote>
<p>First, download and prepare the GWAS and GTEx whole blood data:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://data.broadinstitute.org/alkesgroup/FUSION/SUM/PGC2.SCZ.sumstats</span><br><span class="line"><span class="built_in">mkdir</span> WEIGHTS</span><br><span class="line"><span class="built_in">cd</span> WEIGHTS</span><br><span class="line">wget https://data.broadinstitute.org/alkesgroup/FUSION/WGT/GTEx.Whole_Blood.tar.bz2</span><br><span class="line">tar xjf GTEx.Whole_Blood.tar.bz2</span><br></pre></td></tr></table></figure>

<p>可以用**<a href="https://github.com/bulik/ldsc">LDSC munge_stats.py</a>**把gwas的格式转为我们需要的。 gwas结果全部输入进去，不要卡阈值。</p>
<p>Finally, we run <code>FUSION.test.R</code> using this data on chromosome 22:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Rscript FUSION.assoc_test.R \</span><br><span class="line">--sumstats PGC2.SCZ.sumstats \</span><br><span class="line">--weights ./WEIGHTS/GTEx.Whole_Blood.pos \</span><br><span class="line">--weights_dir ./WEIGHTS/ \</span><br><span class="line">--ref_ld_chr ./LDREF/1000G.EUR. \</span><br><span class="line">--chr 22 \</span><br><span class="line">--out PGC2.SCZ.22.dat</span><br></pre></td></tr></table></figure>



<h3 id="实战——使用FinnGen数据集进行TWAS分析"><a href="#实战——使用FinnGen数据集进行TWAS分析" class="headerlink" title="实战——使用FinnGen数据集进行TWAS分析"></a>实战——使用FinnGen数据集进行TWAS分析</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">##1.数据GWAS 下载链接</span></span><br><span class="line">wget https://storage.googleapis.com/finngen-public-data-r10/summary_stats/finngen_R10_H7_GLAUCCLOSEPRIM.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">##2.数据处理——转换为可以识别的GWAS类型</span></span><br><span class="line">zcat finngen_R10_H7_GLAUCCLOSEPRIM.gz \    <span class="comment"># 解压缩名为 finngen_R10_H7_GLAUCCLOSEPRIM.gz 的文件</span></span><br><span class="line">| awk <span class="string">&#x27;&#123;print $5&quot;\t&quot;$3&quot;\t&quot;$4&quot;\t&quot;$11&quot;\t&quot;$9&quot;\t&quot;$10&quot;\t&quot;$7&quot;&#125;&#x27;</span> \  <span class="comment"># 使用 awk 提取感兴趣的列并按指定格式输出</span></span><br><span class="line">| grep <span class="string">&#x27;rs&#x27;</span> \   <span class="comment"># 过滤包含 &#x27;rs&#x27; 的行</span></span><br><span class="line">| grep -v <span class="string">&#x27;,&#x27;</span> \  <span class="comment"># 过滤掉含有逗号的行</span></span><br><span class="line">&gt; finngen_R10_H7_GLAUCCLOSEPRIM.gwas   <span class="comment"># 将结果保存到 finngen_R10_H7_GLAUCCLOSEPRIM.gwas 文件中</span></span><br></pre></td></tr></table></figure>

<p>下方我们使用ldsc相关软件时候，我们需要进入anaconda的命令行 ，就是安装了相关环境的python中，python2.7，然后munge_sumstats.py执行下列代码</p>
<p>w_hm3.snplist文件从：<a href="https://github.com/perslab/CELLECT/blob/master/data/ldsc/w_hm3.snplist">https://github.com/perslab/CELLECT/blob/master/data/ldsc/w_hm3.snplist</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">###2.TWAS 分析</span></span><br><span class="line"><span class="comment">##处理成TWAS输入格式文件</span></span><br><span class="line"><span class="comment">#清洗数据 </span></span><br><span class="line">munge_sumstats.py \</span><br><span class="line">--sumstats finngen_R10_H7_GLAUCCLOSEPRIM.gwas \</span><br><span class="line">--signed-sumstats beta \</span><br><span class="line">--snp rsids \</span><br><span class="line">--a1 alt \</span><br><span class="line">--a2 ref \</span><br><span class="line">--p pval \</span><br><span class="line">--N 392582 \</span><br><span class="line">--merge-alleles w_hm3.snplist \</span><br><span class="line">--out finngen_R10_H7_GLAUCCLOSEPRIM</span><br><span class="line">--chunksize 500000</span><br><span class="line"></span><br><span class="line"><span class="comment">##超算平台代码</span></span><br><span class="line">python <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/ldsc/munge_sumstats.py&quot;</span>  --sumstats finngen_R10_H7_GLAUCCLOSEPRIM.gwas --merge-alleles --N 392582 --snp rsids  --a1 alt --a2 ref --p pval  --out finngen_R10_H7_GLAUCCLOSEPRIM --chunksize 500000</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里的N指的是研究的样本数量；<br>finngen_R10_H7_GLAUCCLOSEPRIM.gwas是输出的文件名；<br>w_hm3.snplist是被纳入分析的SNP，包含三列：包含rs编号、位置、A1（效应等位基因）、A2（无效等位基因）# 这一步可有可无<br>如果想把所有的SNP位点纳入分析，那么采用这个命令： <code>munge_sumstats.py --sumstats summary.txt --N 17115 --out s</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">##R环境</span></span><br><span class="line">conda activate twasR</span><br><span class="line"></span><br><span class="line"><span class="comment">##twas 分析</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 22); <span class="keyword">do</span> Rscript <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas_master/FUSION.assoc_test.R&quot;</span> --sumstats  finngen_R10_H7_GLAUCCLOSEPRIM.sumstats.gz --weights <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/GTExv8.EUR.Whole_Blood.pos&quot;</span> --weights_dir <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/&quot;</span>  --ref_ld_chr <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas_master/LDREF/1000G.EUR.&quot;</span>  --chr <span class="variable">$i</span> --out qgy_blood_<span class="variable">$i</span>.twas; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 22); <span class="keyword">do</span> </span><br><span class="line">    Rscript <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas-master/FUSION.assoc_test.R&quot;</span> \</span><br><span class="line">    --sumstats  finngen_R10_H7_GLAUCCLOSEPRIM.sumstats.gz \</span><br><span class="line">    --weights <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/GTExv8.EUR.Whole_Blood.pos&quot;</span> \</span><br><span class="line">    --weights_dir <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/&quot;</span> \</span><br><span class="line">    --ref_ld_chr <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas-master/LDREF/1000G.EUR.&quot;</span> \</span><br><span class="line">    --chr <span class="variable">$i</span> \</span><br><span class="line">    --out qgy_blood_<span class="variable">$i</span>.twas </span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>上述使用twas分析需要载入R 所以我们需要在anaconda切换到R所在的环境，并且也要安装需要的R包</p>
<p>weight就是参考使用的，这里用的GTExV8里面的</p>
<h3 id="实战2——LUAD"><a href="#实战2——LUAD" class="headerlink" title="实战2——LUAD"></a>实战2——LUAD</h3><p>在之前一定要配置好相关文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh admin2</span><br><span class="line">screen -<span class="built_in">ls</span></span><br><span class="line">screen -r +地址  <span class="comment">##进入screen操作页面</span></span><br><span class="line"><span class="built_in">cd</span> <span class="string">&quot;/public/home/fanfangzhou/R/2024science/10.LUAD/1.SMR/&quot;</span></span><br><span class="line"><span class="built_in">source</span> activate /public/home/fanfangzhou/anaconda/anaconda3/envs/ldsc  <span class="comment">##这里就是之前LDSC配置的python2.7环境</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#LUAD.ma的数据包括：SNP    A1  A2  freq    b   se  p   n 这些数据，是按照标准的SMR需要的gwas格式整理的</span></span><br><span class="line">python <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/ldsc/munge_sumstats.py&quot;</span>  --sumstats LUAD.ma  --N 66756 --out LUAD --chunksize 500000</span><br><span class="line"></span><br><span class="line">conda activate /public/home/fanfangzhou/anaconda/anaconda3/envs/twasR</span><br><span class="line"><span class="comment">##twas 分析：whole blood</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 22); <span class="keyword">do</span> Rscript <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas_master/FUSION.assoc_test.R&quot;</span> --sumstats  LUAD.sumstats.gz --weights <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/GTExV8.EUR/GTExv8.EUR.Whole_Blood.pos&quot;</span> --weights_dir <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/GTExV8.EUR/&quot;</span>  --ref_ld_chr <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas_master/LDREF/1000G.EUR.&quot;</span>  --chr <span class="variable">$i</span> --out TWAS_Whole_Blood_<span class="variable">$i</span>.twas; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##twas 分析：lung</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 22); <span class="keyword">do</span> Rscript <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas_master/FUSION.assoc_test.R&quot;</span> --sumstats  LUAD.sumstats.gz --weights <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/GTExV8.EUR/GTExv8.EUR.Lung.pos&quot;</span> --weights_dir <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/GTExV8/GTExV8.EUR/&quot;</span>  --ref_ld_chr <span class="string">&quot;/public/home/fanfangzhou/R/TWAS/fusion_twas_master/LDREF/1000G.EUR.&quot;</span>  --chr <span class="variable">$i</span> --out LUAD_lung_<span class="variable">$i</span>.twas; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>





<h3 id="TWAS-相关数据库"><a href="#TWAS-相关数据库" class="headerlink" title="TWAS 相关数据库"></a>TWAS 相关数据库</h3><ul>
<li><a href="https://ngdc.cncb.ac.cn/twas/">Home - TWAS Atlas - CNCB-NGDC</a></li>
</ul>
<h3 id="TWAS-可使用的参数模型"><a href="#TWAS-可使用的参数模型" class="headerlink" title="TWAS 可使用的参数模型"></a>TWAS 可使用的参数模型</h3><h4 id="GTEx-v8-multi-tissue-expression"><a href="#GTEx-v8-multi-tissue-expression" class="headerlink" title="GTEx v8 multi-tissue expression"></a>GTEx v8 multi-tissue expression</h4><p>Each archive contains two sets of <code>pos</code> files, one for genes with significant heritability and one for all genes (labeled <code>no_filter</code>). Using genes that achieved significant heritability is recommended for typical analyses. Using weights from “All Samples” will also typically increase sensitivity, unless analyzing highly European-specific regions. A detailed comparison of models by population and GTEx version is provided <a href="http://gusevlab.org/projects/fusion/gtex_v8.html">here</a>. Positions in the <code>pos</code> files are taken from GTEx annotations.</p>
<p>Weights were kindly estimated and provided by Junghyun Jung in the <a href="https://www.mancusolab.com/">Mancuso lab</a>.</p>
<table>
<thead>
<tr>
<th>Tissue</th>
<th>All Samples</th>
<th>link</th>
<th>EUR Samples</th>
<th>link</th>
</tr>
</thead>
<tbody><tr>
<td>Adipose - Subcutaneous</td>
<td>581</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Adipose_Subcutaneous.tar.gz">download</a></td>
<td>479</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Adipose_Subcutaneous.tar.gz">download</a></td>
</tr>
<tr>
<td>Adipose - Visceral (Omentum)</td>
<td>469</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Adipose_Visceral_Omentum.tar.gz">download</a></td>
<td>393</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Adipose_Visceral_Omentum.tar.gz">download</a></td>
</tr>
<tr>
<td>Adrenal Gland</td>
<td>233</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Adrenal_Gland.tar.gz">download</a></td>
<td>194</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Adrenal_Gland.tar.gz">download</a></td>
</tr>
<tr>
<td>Artery - Aorta</td>
<td>387</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Artery_Aorta.tar.gz">download</a></td>
<td>329</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Artery_Aorta.tar.gz">download</a></td>
</tr>
<tr>
<td>Artery - Coronary</td>
<td>213</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Artery_Coronary.tar.gz">download</a></td>
<td>175</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Artery_Coronary.tar.gz">download</a></td>
</tr>
<tr>
<td>Artery - Tibial</td>
<td>584</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Artery_Tibial.tar.gz">download</a></td>
<td>476</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Artery_Tibial.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Amygdala</td>
<td>129</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Amygdala.tar.gz">download</a></td>
<td>119</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Amygdala.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Anterior cingulate cortex (BA24)</td>
<td>147</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Anterior_cingulate_cortex_BA24.tar.gz">download</a></td>
<td>135</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Anterior_cingulate_cortex_BA24.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Caudate (basal ganglia)</td>
<td>194</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Caudate_basal_ganglia.tar.gz">download</a></td>
<td>172</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Caudate_basal_ganglia.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Cerebellar Hemisphere</td>
<td>175</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Cerebellar_Hemisphere.tar.gz">download</a></td>
<td>157</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Cerebellar_Hemisphere.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Cerebellum</td>
<td>209</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Cerebellum.tar.gz">download</a></td>
<td>188</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Cerebellum.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Cortex</td>
<td>205</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Cortex.tar.gz">download</a></td>
<td>183</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Cortex.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Frontal Cortex (BA9)</td>
<td>175</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Frontal_Cortex_BA9.tar.gz">download</a></td>
<td>157</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Frontal_Cortex_BA9.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Hippocampus</td>
<td>165</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Hippocampus.tar.gz">download</a></td>
<td>150</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Hippocampus.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Hypothalamus</td>
<td>170</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Hypothalamus.tar.gz">download</a></td>
<td>156</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Hypothalamus.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Nucleus accumbens (basal ganglia)</td>
<td>202</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Nucleus_accumbens_basal_ganglia.tar.gz">download</a></td>
<td>181</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Nucleus_accumbens_basal_ganglia.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Putamen (basal ganglia)</td>
<td>170</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Putamen_basal_ganglia.tar.gz">download</a></td>
<td>153</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Putamen_basal_ganglia.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Spinal cord (cervical c-1)</td>
<td>126</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Spinal_cord_cervical_c-1.tar.gz">download</a></td>
<td>115</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Spinal_cord_cervical_c-1.tar.gz">download</a></td>
</tr>
<tr>
<td>Brain - Substantia nigra</td>
<td>114</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Brain_Substantia_nigra.tar.gz">download</a></td>
<td>100</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Brain_Substantia_nigra.tar.gz">download</a></td>
</tr>
<tr>
<td>Breast - Mammary Tissue</td>
<td>396</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Breast_Mammary_Tissue.tar.gz">download</a></td>
<td>329</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Breast_Mammary_Tissue.tar.gz">download</a></td>
</tr>
<tr>
<td>Skin - Transformed fibroblasts</td>
<td>483</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Cells_Cultured_fibroblasts.tar.gz">download</a></td>
<td>403</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Cells_Cultured_fibroblasts.tar.gz">download</a></td>
</tr>
<tr>
<td>Blood - EBV-transformed lymphocytes</td>
<td>147</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Cells_EBV-transformed_lymphocytes.tar.gz">download</a></td>
<td>113</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Cells_EBV-transformed_lymphocytes.tar.gz">download</a></td>
</tr>
<tr>
<td>Colon - Sigmoid</td>
<td>318</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Colon_Sigmoid.tar.gz">download</a></td>
<td>266</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Colon_Sigmoid.tar.gz">download</a></td>
</tr>
<tr>
<td>Colon - Transverse</td>
<td>368</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Colon_Transverse.tar.gz">download</a></td>
<td>294</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Colon_Transverse.tar.gz">download</a></td>
</tr>
<tr>
<td>Esophagus - Gastroesophageal Junction</td>
<td>330</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Esophagus_Gastroesophageal_Junction.tar.gz">download</a></td>
<td>275</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Esophagus_Gastroesophageal_Junction.tar.gz">download</a></td>
</tr>
<tr>
<td>Esophagus - Mucosa</td>
<td>497</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Esophagus_Mucosa.tar.gz">download</a></td>
<td>411</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Esophagus_Mucosa.tar.gz">download</a></td>
</tr>
<tr>
<td>Esophagus - Muscularis</td>
<td>465</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Esophagus_Muscularis.tar.gz">download</a></td>
<td>385</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Esophagus_Muscularis.tar.gz">download</a></td>
</tr>
<tr>
<td>Heart - Atrial Appendage</td>
<td>372</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Heart_Atrial_Appendage.tar.gz">download</a></td>
<td>316</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Heart_Atrial_Appendage.tar.gz">download</a></td>
</tr>
<tr>
<td>Heart - Left Ventricle</td>
<td>386</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Heart_Left_Ventricle.tar.gz">download</a></td>
<td>327</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Heart_Left_Ventricle.tar.gz">download</a></td>
</tr>
<tr>
<td>Kidney - Cortex</td>
<td>73</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Kidney_Cortex.tar.gz">download</a></td>
<td>65</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Kidney_Cortex.tar.gz">download</a></td>
</tr>
<tr>
<td>Liver</td>
<td>208</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Liver.tar.gz">download</a></td>
<td>178</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Liver.tar.gz">download</a></td>
</tr>
<tr>
<td>Lung</td>
<td>515</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Lung.tar.gz">download</a></td>
<td>436</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Lung.tar.gz">download</a></td>
</tr>
<tr>
<td>Minor Salivary Gland</td>
<td>144</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Minor_Salivary_Gland.tar.gz">download</a></td>
<td>114</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Minor_Salivary_Gland.tar.gz">download</a></td>
</tr>
<tr>
<td>Muscle - Skeletal</td>
<td>706</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Muscle_Skeletal.tar.gz">download</a></td>
<td>588</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Muscle_Skeletal.tar.gz">download</a></td>
</tr>
<tr>
<td>Nerve - Tibial</td>
<td>532</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Nerve_Tibial.tar.gz">download</a></td>
<td>438</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Nerve_Tibial.tar.gz">download</a></td>
</tr>
<tr>
<td>Ovary</td>
<td>167</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Ovary.tar.gz">download</a></td>
<td>138</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Ovary.tar.gz">download</a></td>
</tr>
<tr>
<td>Pancreas</td>
<td>305</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Pancreas.tar.gz">download</a></td>
<td>243</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Pancreas.tar.gz">download</a></td>
</tr>
<tr>
<td>Pituitary</td>
<td>237</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Pituitary.tar.gz">download</a></td>
<td>219</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Pituitary.tar.gz">download</a></td>
</tr>
<tr>
<td>Prostate</td>
<td>221</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Prostate.tar.gz">download</a></td>
<td>181</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Prostate.tar.gz">download</a></td>
</tr>
<tr>
<td>Skin - Not Sun Exposed (Suprapubic)</td>
<td>517</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Skin_Not_Sun_Exposed_Suprapubic.tar.gz">download</a></td>
<td>430</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Skin_Not_Sun_Exposed_Suprapubic.tar.gz">download</a></td>
</tr>
<tr>
<td>Skin - Sun Exposed (Lower leg)</td>
<td>605</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Skin_Sun_Exposed_Lower_leg.tar.gz">download</a></td>
<td>508</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Skin_Sun_Exposed_Lower_leg.tar.gz">download</a></td>
</tr>
<tr>
<td>Small Intestine - Terminal Ileum</td>
<td>174</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Small_Intestine_Terminal_Ileum.tar.gz">download</a></td>
<td>141</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Small_Intestine_Terminal_Ileum.tar.gz">download</a></td>
</tr>
<tr>
<td>Spleen</td>
<td>227</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Spleen.tar.gz">download</a></td>
<td>179</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Spleen.tar.gz">download</a></td>
</tr>
<tr>
<td>Stomach</td>
<td>324</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Stomach.tar.gz">download</a></td>
<td>260</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Stomach.tar.gz">download</a></td>
</tr>
<tr>
<td>Testis</td>
<td>322</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Testis.tar.gz">download</a></td>
<td>272</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Testis.tar.gz">download</a></td>
</tr>
<tr>
<td>Thyroid</td>
<td>574</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Thyroid.tar.gz">download</a></td>
<td>482</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Thyroid.tar.gz">download</a></td>
</tr>
<tr>
<td>Uterus</td>
<td>129</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Uterus.tar.gz">download</a></td>
<td>107</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Uterus.tar.gz">download</a></td>
</tr>
<tr>
<td>Vagina</td>
<td>141</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Vagina.tar.gz">download</a></td>
<td>120</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Vagina.tar.gz">download</a></td>
</tr>
<tr>
<td>Whole Blood</td>
<td>670</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/ALL/GTExv8.ALL.Whole_Blood.tar.gz">download</a></td>
<td>558</td>
<td><a href="https://s3.us-west-1.amazonaws.com/gtex.v8.fusion/EUR/GTExv8.EUR.Whole_Blood.tar.gz">download</a></td>
</tr>
</tbody></table>
<p><em>For reproducibility, legacy models from GTEx v7 are available for <a href="http://gusevlab.org/projects/fusion/weights/GTEX7.txt">significant genes</a> and <a href="http://gusevlab.org/projects/fusion/weights/GTEX7ALL.txt">all genes</a>. Legacy models from GTEx v6 are also available for <a href="https://data.broadinstitute.org/alkesgroup/FUSION/WGT/GTEx.ALL.tar">significant genes</a>. See <a href="http://gusevlab.org/projects/fusion/gtex.html">here</a> for a comparison of GTEx v6 and v7 model performance.</em></p>
]]></content>
      <categories>
        <category>Post-GWAS analysis</category>
      </categories>
  </entry>
</search>
